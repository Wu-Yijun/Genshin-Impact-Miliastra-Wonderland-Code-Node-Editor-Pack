# 项目的各功能计划与完成清单(长期更新)

## 已完成的功能
*按完成时间由近到远排序*

- **2025-12-03**: 完成 `DSL-IR` 编译器 - 完整编译器 - 常量和临时变量定义, 声明, lambda 与 Component, 导入
- **2025-12-03**: 完成 `IR-DSL` 反编译 - 块级编译器
- **2025-12-03**: 重写 `DSL-IR` 编译器 - 块级编译器
- **2025-12-03**: 重构 Parser 运行逻辑
- **2025-12-02**: 测试 Graph 接口: 虽然有 Bug 但不管怎么说至少可以顺利导入/导出并产生一致性的结果了.
- **2025-12-02**: 重构 IR 结构
- **2025-12-02**: 迁移底层数据结构
- **2025-12-02**: 微调 tokenizer
- **2025-12-02**: 对比双方数据的差异
- **2025-12-02**: 绘制 ID 分布热力图
- **2025-12-02**: 完成 Graph 接口
- **2025-12-02**: 完成 Graph 类的 val 的 decode.
- **2025-12-02**: 完成 Graph 类的 connects 机制 decode.
- **2025-12-02**: 完成 Graph 类的 comments 的读写.
- **2025-12-01**: 添加了一个测试用例
- **2025-12-01**: 添加了自动构建测试.
- **2025-12-01**: 添加了对列表类型数据初值设置的支持.
- **2025-12-01**: 完成 Graph 类 encode 时的 auto layout.
- **2025-12-01**: 完成 Graph 类的 value set 接口
- **2025-12-01**: 完成 Graph 类的 flow 机制
- **2025-12-01**: 修改一些名称, 并全局检查同步修改
- **2025-12-01**: 更新 gia.proto, 并添加了 Message Comments 
<details>
<summary>更早的内容:</summary>

- **2025-11-30**: 更新文档
- **2025-11-30**: 根据 node_data 的 ts 文件, 更新 yaml 文件.
- **2025-11-30**: 根据 node_data 的 ts 文件, 完善 NodeId 列表
- **2025-11-30**: VarType = 16, local variable, 相关内容, VariableSnapshot=28
- **2025-11-30**: MovementMode_InstantMovement, FixedMotionParameterType_FixedTime
- **2025-11-30**: 算法bug导致我似乎遗漏了一些节点, 完整的重新检查.
- **2025-11-30**: 完成非反射引脚的创建
- **2025-11-29**: 手动补全 35 多个非常规类型引脚, 补全枚举和类型定义
- **2025-11-29**: 利用不同类型连线会被断开的机制, 提取节点常规引脚类型.
- **2025-11-29**: 整理了输入节点连线类型
- **2025-11-29**: 调查两组 PinIndex 差异的来源: 似乎是固定的, 但无规律可循, 且 i2 导入时不被载入.
- **2025-11-29**: 添加了若干隐藏节点的名字
- **2025-11-29**: 添加 Graph 类的 connects 机制, 并完成 encode
- **2025-11-28**: 调整 gia.proto , 将 NodeId 枚举移除, 放入独立 ts 文件
- **2025-11-28**: 节点图连线编解码分析: 非常简单, 连就完事了...
- **2025-11-28**: 服务器节点图的名称和 id 列表整理: node_pin_records.ts
- **2025-11-28**: 查找/分析连续节点 id 的空缺部分的内容: 结论: 共缺失 128 个, 估计是 `Struct` 和 `List<Struct>` 的 id
- **2025-11-28**: 简单测试 Graph 类.
- **2025-11-28**: 服务器节点图管理类 - 为类写一个说明文档
- **2025-11-28**: 服务器节点图管理类 - decode 从 gia 结构转化为类
- **2025-11-28**: 服务器节点图管理类 - 图和节点的快速定义和修改功能
- **2025-11-28**: 服务器节点图管理类 - encode 导出为 gia 结构
- **2025-11-28**: 添加任务列表 `todo.md`
- **2025-11-28**: 创建 dev 作为工作分支, 并自动同步 main 分支.
- (更早的列表未记录)

</details>


## 进行中
*按任务优先级和完成度排序, 打勾的说明已经开始, 仍未完成*

- [ ] 测试 Parser, decompiler 的全部功能
- [ ] 添加 Parser, decompiler 的自动化 CI 测试
- [ ] 更新文档
- [ ] 解析复合节点, 添加接口
- [ ] 定义 DSL 函数签名和与原神对应关系
- [ ] 重构 basic.ts , 完成对于 Map 键值和 Struct 键值的写入与任意类型的写入

## 计划
*按规划中先后实现顺序排序, 条目会在实际项目进行中展开更多细节*


- [ ] VSCode 中 `.dsl.ts` 语言扩展
- [ ] 运行器 - 调度框架/用户界面
- [ ] 客户端节点信息提取
- [ ] 运行模拟 - 对更多系统函数进行转化处理为可模拟项目
- [ ] 编译器自动类型推断
- [ ] add Enum, VarSnapshot, LocalVar for SysTypes
- [ ] 分析**简单** struct 的结构, 补全服务器 ID 列表. // 似乎结构体没有 Concrete ID?